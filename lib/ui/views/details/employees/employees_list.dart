import 'package:flutter/material.dart';import 'package:flutter/painting.dart';import 'package:gym_bar/core/enums.dart';import 'package:gym_bar/core/models/employee.dart';import 'package:gym_bar/core/view_models/employee_model.dart';import 'package:gym_bar/core/view_models/transaction_model.dart';import 'package:gym_bar/ui/shared/dimensions.dart';import 'package:gym_bar/ui/shared/text_styles.dart';import 'package:provider/provider.dart';class EmployeesList extends StatelessWidget {  @override  Widget build(BuildContext context) {    TransactionModel transactionModel =        Provider.of<TransactionModel>(context, listen: false);    EmployeeModel employeeModel = Provider.of<EmployeeModel>(context);    String selectedEmployeeType = employeeModel.selectedEmployeeType;    List<Employee> filteredEmployees =        employeeModel.filterEmployees(selectedEmployeeType);    Dimensions _dimensions = Dimensions(context);    TextStyles _textStyles = TextStyles(context: context);    bool nameAscending = employeeModel.nameAscending;    bool cashAscending = employeeModel.cashAscending;    onSortName() {      nameAscending          ? filteredEmployees.sort((a, b) => a.name.compareTo(b.name))          : filteredEmployees.sort((a, b) => b.name.compareTo(a.name));    }    onSortCash() {      cashAscending          ? filteredEmployees.sort((a, b) => a.cash.compareTo(b.cash))          : filteredEmployees.sort((a, b) => b.cash.compareTo(a.cash));    }    Widget popUpSortSelection() => PopupMenuButton<SortSelection>(        icon: Icon(          Icons.sort,          size: _dimensions.heightPercent(3),        ),        onSelected: (SortSelection selectedSort) {          if (selectedSort == SortSelection.sortByName) {            onSortName();            employeeModel.changeNameAscendingState();            employeeModel.changeCashAscendingState();          }          if (selectedSort == SortSelection.sortByCash) {            onSortCash();            employeeModel.changeNameAscendingState();            employeeModel.changeCashAscendingState();          }        },        itemBuilder: (BuildContext context) {          return [            PopupMenuItem<SortSelection>(              child: Text("تصنيف حسب الاسم"),              value: SortSelection.sortByName,            ),            PopupMenuItem<SortSelection>(              child: Text("تصنيف حسب الرصيد"),              value: SortSelection.sortByCash,            ),          ];        });    List<Widget> employeeTypeChoices() {      return [        ChoiceChip(          padding: EdgeInsets.symmetric(              horizontal: _dimensions.widthPercent(5),              vertical: _dimensions.heightPercent(0.4)),          labelStyle: _textStyles.chipLabelStyleLight(),          selectedColor: Colors.blue,          backgroundColor: Colors.white,          shape: StadiumBorder(            side: BorderSide(color: Colors.blue),          ),          label: Text("مدين"),          selected: selectedEmployeeType == "مدين",          onSelected: (_) => employeeModel.selectedEmployeeType = "مدين",        ),        SizedBox(width: _dimensions.widthPercent(2)),        ChoiceChip(          padding: EdgeInsets.symmetric(              horizontal: _dimensions.widthPercent(5),              vertical: _dimensions.heightPercent(0.4)),          labelStyle: _textStyles.chipLabelStyleLight(),          backgroundColor: Colors.white,          selectedColor: Colors.blue,          shape: StadiumBorder(side: BorderSide(color: Colors.blue)),          label: Text("دائن"),          selected: selectedEmployeeType == "دائن",          onSelected: (_) => employeeModel.selectedEmployeeType = "دائن",        ),        SizedBox(width: _dimensions.widthPercent(2)),        ChoiceChip(          padding: EdgeInsets.symmetric(              horizontal: _dimensions.widthPercent(5),              vertical: _dimensions.heightPercent(0.4)),          labelStyle: _textStyles.chipLabelStyleLight(),          backgroundColor: Colors.white,          selectedColor: Colors.blue,          shape: StadiumBorder(            side: BorderSide(color: Colors.blue),          ),          label: Text("الكل"),          selected: selectedEmployeeType == "all",          onSelected: (_) => employeeModel.selectedEmployeeType = "all",        ),      ];    }    employeesList() {      return Consumer<List<Employee>>(        builder: (_, employees, __) {          return employees == null || employeeModel.status == Status.Busy              ? Center(child: CircularProgressIndicator())              : ListView.builder(                  itemCount: filteredEmployees.length,                  itemBuilder: (BuildContext context, int index) {                    return Padding(                      padding: EdgeInsets.symmetric(                          vertical: _dimensions.heightPercent(0.4),                          horizontal: _dimensions.widthPercent(1)),                      child: Card(                        color: Colors.white,                        shape: RoundedRectangleBorder(                          borderRadius: BorderRadius.circular(                              _dimensions.heightPercent(1)),                        ),                        child: ListTileTheme(                          selectedColor: employees                                      .firstWhere((element) =>                                          element.id ==                                          filteredEmployees[index].id)                                      .type ==                                  'دائن'                              ? Colors.red                              : Colors.blue,                          child: ListTile(                            leading: Icon(                              Icons.account_circle,                              size: _dimensions.heightPercent(4),                            ),                            title: Text(filteredEmployees[index].name),                            subtitle: Text(                                employees                                    .firstWhere((element) =>                                        element.id ==                                        filteredEmployees[index].id)                                    .cash,                                style: TextStyle(                                    color: employees                                                .firstWhere((element) =>                                                    element.id ==                                                    filteredEmployees[                                                            index]                                                        .id)                                                .type ==                                            'دائن'                                        ? Colors.red                                        : Colors.green)),                            onTap: () {                              employeeModel.selectedEmployee =                                  employees.firstWhere((element) =>                                      element.id ==                                      filteredEmployees[index].id);                              transactionModel                                  .fetchTransactionByCustomerName(                                      branchName: "بيفرلي",                                      customerName:                                          filteredEmployees[index].name);                              Navigator.pushNamed(                                  context, '/one_employee_info');                            },                          ),                        ),                      ),                    );                  },                );        },      );    }    return Scaffold(      appBar: AppBar(),      body: Column(        children: [          SizedBox(height: _dimensions.heightPercent(3)),          Row(            mainAxisAlignment: MainAxisAlignment.spaceEvenly,            children: employeeTypeChoices(),          ),          SizedBox(height: _dimensions.heightPercent(1)),          Row(            children: [              SizedBox(                width: _dimensions.widthPercent(2),              ),              popUpSortSelection(),            ],          ),          Expanded(child: employeesList()),          // Container(          //     height: _dimensions.heightPercent(50), child: employeesList()),        ],      ),    );  }}