import 'package:flutter/material.dart';import 'package:gym_bar/core/enums.dart';import 'package:gym_bar/core/models/transaction.dart';import 'package:gym_bar/core/view_models/transaction_model.dart';import 'package:gym_bar/ui/shared/text_styles.dart';import 'package:gym_bar/ui/shared/ui_helpers.dart';import 'package:gym_bar/ui/views/base_view.dart';class Purchases extends StatefulWidget {  final Map<String, dynamic> args;  const Purchases({Key key, this.args}) : super(key: key);  @override  _PurchasesState createState() => _PurchasesState();}class _PurchasesState extends State<Purchases> {  bool buyAmountAscending = false;  bool buyCompanyNameAscending = false;  bool transactorNameAscending = false;  IconData sortBuyAmountIcon = Icons.sort;  IconData sortBuyCompanyNameIcon = Icons.sort;  IconData sortTransactorNameIcon = Icons.sort;  String sendNull = "لا يوجد";  onSortBuyAmount(List<Transaction> transactions) {    if (buyAmountAscending) {      setState(() {        sortBuyAmountIcon = Icons.keyboard_arrow_down;        sortBuyCompanyNameIcon = Icons.sort;        sortTransactorNameIcon = Icons.sort;      });      transactions.sort(          (a, b) => a.buyingCashAmount.compareTo(b.buyingCashAmount));    } else {      setState(() {        sortBuyAmountIcon = Icons.keyboard_arrow_up;        sortBuyCompanyNameIcon = Icons.sort;        sortTransactorNameIcon = Icons.sort;      });      transactions.sort(          (a, b) => b.buyingCashAmount.compareTo(a.buyingCashAmount));    }  }  onSortBuyCompanyName(List<Transaction> transactions) {    if (buyCompanyNameAscending) {      setState(() {        sortBuyCompanyNameIcon = Icons.keyboard_arrow_down;        sortTransactorNameIcon = Icons.sort;        sortBuyAmountIcon = Icons.sort;      });      transactions.sort(          (a, b) => a.buyingCompanyName.compareTo(b.buyingCompanyName));    } else {      setState(() {        sortBuyCompanyNameIcon = Icons.keyboard_arrow_up;        sortTransactorNameIcon = Icons.sort;        sortBuyAmountIcon = Icons.sort;      });      transactions.sort(          (a, b) => b.buyingCompanyName.compareTo(a.buyingCompanyName));    }  }  onSortTransactorName(List<Transaction> transactions) {    if (transactorNameAscending) {      setState(() {        sortTransactorNameIcon = Icons.keyboard_arrow_down;        sortBuyCompanyNameIcon = Icons.sort;        sortBuyAmountIcon = Icons.sort;      });      transactions          .sort((a, b) => a.transactorName.compareTo(b.transactorName));    } else {      setState(() {        sortTransactorNameIcon = Icons.keyboard_arrow_up;        sortBuyCompanyNameIcon = Icons.sort;        sortBuyAmountIcon = Icons.sort;      });      transactions          .sort((a, b) => b.transactorName.compareTo(a.transactorName));    }  }  changeBuyAmountAscendingState() {    setState(() {      buyAmountAscending = !buyAmountAscending;    });  }  changeBuyCompanyNameAscendingState() {    setState(() {      buyCompanyNameAscending = !buyCompanyNameAscending;    });  }  changeTransactorNameAscendingState() {    setState(() {      transactorNameAscending = !transactorNameAscending;    });  }  tableHead(transactions) {    return Container(      height: 50,      color: Colors.grey,      child: Row(        mainAxisAlignment: MainAxisAlignment.spaceAround,        children: <Widget>[          GestureDetector(              onTap: () {                changeBuyAmountAscendingState();                onSortBuyAmount(transactions);              },              child: Center(                  child: Row(                mainAxisAlignment: MainAxisAlignment.center,                children: <Widget>[                  Text("المبلغ المدفوع", style: tableTitleStyle),                  SizedBox(width: 10),                  Icon(sortBuyAmountIcon)                ],              ))),          GestureDetector(              onTap: () {                changeBuyCompanyNameAscendingState();                onSortBuyCompanyName(transactions);              },              child: Center(                  child: Row(                mainAxisAlignment: MainAxisAlignment.center,                children: <Widget>[                  Text("اسم الشركه", style: tableTitleStyle),                  SizedBox(width: 10),                  Icon(sortBuyCompanyNameIcon)                ],              ))),          GestureDetector(              onTap: () {                changeTransactorNameAscendingState();                onSortTransactorName(transactions);              },              child: Center(                  child: Row(                mainAxisAlignment: MainAxisAlignment.center,                children: <Widget>[                  Text("اسم المسؤول", style: tableTitleStyle),                  SizedBox(width: 10),                  Icon(sortTransactorNameIcon)                ],              ))),        ],      ),    );  }  tableBuilder(List<Transaction> transactions) {    return ListView.builder(        itemCount: transactions.length,        itemBuilder: (BuildContext context, int index) {          return Column(            children: <Widget>[              Container(                height: 50,                child: GestureDetector(                  onTap: () {},                  child: Row(                    mainAxisAlignment: MainAxisAlignment.spaceAround,                    children: <Widget>[                      Text(                          transactions[index].hour == ""                              ? 'null'                              : transactions[index].buyingCashAmount,                          style: formTitleStyleLight),                      Text(transactions[index].buyingCompanyName,                          style: formTitleStyleLight),                      Text(transactions[index].transactorName,                          style: formTitleStyleLight),                    ],                  ),                ),              ),              Divider(height: 1, color: Colors.black),            ],          );        });  }  table(transactions) {    return Column(      children: <Widget>[        tableHead(transactions),        Divider(          thickness: 3,          color: Colors.black54,          height: 3,        ),        Expanded(child: tableBuilder(transactions)),      ],    );  }  @override  Widget build(BuildContext context) {    print(widget.args['branchName']);    return BaseView<TransactionModel>(      onModelReady: (model) => model.fetchFilteredTransaction(        branchName: widget.args['branchName'],        field: 'date',        equalTo: widget.args['date'],        field2: 'transactionType',        equalTo2: widget.args['buying'],      ),      builder: (context, model, child) => Scaffold(        appBar: AppBar(          title: Text(widget.args['date']),        ),        body: model.state == ViewState.Busy            ? Center(child: CircularProgressIndicator())//              : alternativeTabel(model.employees)            : Column(                crossAxisAlignment: CrossAxisAlignment.stretch,                children: <Widget>[                  UIHelper.verticalSpaceLarge(),                  Expanded(child: table(model.transaction)),                ],              ),      ),    );  }}